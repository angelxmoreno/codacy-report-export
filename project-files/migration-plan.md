# Migration Plan

## Overview

We are transitioning from a single CLI prototype into a monorepo that houses a Codacy API SDK, the report-export CLI, and documentation apps. Below is the staged plan with context and dependencies.

## Phases

1. **Finish Current Branch**
   * Implement only the API calls required for the MVP exporter (user lookup, repository scoped issues, PR issues).
   * Open a PR to get the foundational service, schemas, and CLI plumbing merged quickly.
   * Rationale: unblock downstream work, avoid letting the branch accumulate unrelated scope.

2. **Monorepo Conversion**
   * Restructure the repository (likely via pnpm workspaces or Bun workspaces) so we can host multiple packages/apps.
   * Introduce top-level tooling (lint/test) that runs across packages.
   * Needs coordination with CI and release workflows.

3. **Codacy Typed SDK Generation**
   * Create a `codacy-typed-sdk` package that combines:
     * `openapi-zod-client` for Zod schemas + runtime validation.
     * `@codacy/openapi-typescript-codegen` for autogenerated fetch/axios clients.
   * Wire generators to the official swagger (`https://api.codacy.com/api/api-docs/swagger.yaml`), add lightweight wrappers, and publish as a standalone npm module.
   * This SDK becomes the source of truth for all Codacy API interactions (including the exporter).

4. **Complete codacy-report-export**
   * Refactor the CLI to consume the SDK rather than rolling custom service code.
   * Implement the full PR export pipeline (fetch PR issues, normalize, emit agent-ready reports).
   * Add tests/integration flows against the SDK mocks.

5. **Documentation Apps**
   * Build two small apps (or static sites) for documentation:
     * One for `codacy-typed-sdk` (API reference + usage guides).
     * One for `codacy-report-export` (CLI usage, automation examples).
   * Host inside the monorepo (e.g., `/apps/sdk-docs`, `/apps/export-docs`) so they can share tooling.

## Notes

* The `docs/` folder is gitignored, so long-form docs live in `project-files/docs/` going forward.
* Each phase should land as its own PR/series to keep reviews manageable.
* When generating SDKs, ensure CI caches openapi downloads and enforces deterministic output.
